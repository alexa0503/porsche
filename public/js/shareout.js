function H5Loader(){}H5Loader.prototype.constructor=H5Loader;H5Loader.loadImg=function(e,t,n,i){var r=$(e);var o=0;function a(){o++;t.call(i,o,r.length);if(o==r.length){n.call(i)}}for(var s=0;s<r.length;s++){var c=r[s];if(!$(c).attr("original-data")){continue}var u=$(c).attr("original-data");c.onload=c.onerror=function(){a()};if(!u){console.log(u,c)}if(u==undefined){console.log("错误",c)}c.src=u}};H5Loader.loadImg_oj=function(e,t,n,i){var r=OJ.getAll(e);var o=0;function a(){o++;t.call(i,o,r.length);if(o==r.length){n.call(i)}}for(var s=0;s<r.length;s++){var c=r[s];var u=c.getAttribute("original-data");c.onload=c.onerror=function(){a()};c.src=u}};H5Loader.delayloadjs=function(e,t,n,i,r){if(r==undefined)r=false;var o=0;window.delyjsok=function(){o++;if(o==e.length){n.call(i)}else{t.call(i)}};e.map(function(e,t,n){var i=document.getElementsByTagName("head")[0];var o=document.createElement("script");o.type="text/javascript";if(r)e=e+"?r="+Math.random();o.src=e;o.setAttribute("onload","window.delyjsok();");i.appendChild(o)})};H5Loader.loadMp3_oj_dy=function(e,t,n,i){var r=[];var o=e.length;var a=0;function s(){a++;if(t){t.call(i,a,o)}if(a==o){if(n){n.call(i,r)}}}for(var c=0;c<e.length;c++){var u=e[c];var l=new Audio(u);l.onloadedmetadata=s;l.src=u;r.push(l)}};H5Loader.loadImg2=function(e,t,n,i,r,o){var a=[];var s=uMath.random(14);var c=0;var u=[];var l=$('<div class="abs temp'+s+'"></div>');$("body").append(l);l.css("left","-10000px");l.css("top","-10000px");var f=l[0];function v(){c++;if(r){t.call(i,c,e.length,o)}else{t.call(i,c,e.length)}if(c==e.length){if(o){o.unshift(a);n.apply(i,o)}else{n.call(i,a)}}else{}}for(var d=0;d<e.length;d++){var p=e[d];var g=new Image;g.onload=g.onerror=function(){this.style.display="none";v()};g.src=p;a.push(g);f.appendChild(g)}};function JSdebug(){}JSdebug.prototype.constructor=JSdebug;JSdebug.initDebug=function(){if(OJ.getAll(".debug").length==0){var e=document.createElement("div");e.setAttribute("class","debug");window.document.body.appendChild(e)}};JSdebug.print=function(){JSdebug.trace.apply(JSdebug,arguments)};JSdebug.trace=function(){var e=[];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}var n=OJ.getOne(".debug");if(!n)return;var i=n.innerText;n.innerText=(e.join("    ")+""+i).substring(0,500)};JSdebug.clear=function(){var e=OJ.getOne(".debug");if(e)e.innerText=""};function OJ(){}OJ.prototype.constructor=OJ;OJ.GetQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");var n=window.location.search.substr(1).match(t);if(n!=null)return unescape(n[2]);return null};OJ.getSub=function(e,t){var n=t.split(" ");var i=e;var r=[];function o(e,t){if(t.indexOf(".")==0){t=t.replace(".","");_outArr2=e.getElementsByClassName(t);v=[];for(var n=0;n<_outArr2.length;n++){v.push(_outArr2[n])}}else if(t.indexOf("#")==0){t=t.replace("#","");v=[e.getElementById(t)]}else{_outArr2=e.getElementsByTagName(t);v=[];for(var n=0;n<_outArr2.length;n++){v.push(_outArr2[n])}}return v}var a=[i];var s=0;while(n.length){var c=n.shift();if(c==""){continue}var u=[];for(var l=0;l<a.length;l++){var f=a[l];var v=o(f,c);u=u.concat(v)}a=u.concat();s++}for(var d=0;d<v.length;d++){r.push(v[d])}return r};OJ.getAll=function(e){return OJ.getSub(document,e)};OJ.getOne=function(e){return OJ.getSub(document,e)[0]};OJ.offset=function(e){var t={top:0,left:0};OJ.getOffset(t,e,true);return t};OJ.getOffset=function(e,t,n){var i;if(t.nodeType!==1){return}i=window.getComputedStyle(t)["position"];if(typeof n==="undefined"&&i==="static"){OJ.getOffset(e,t.parentNode);return}e.top=t.offsetTop+e.top-t.scrollTop;e.left=t.offsetLeft+e.left-t.scrollLeft;if(i==="fixed"){return}OJ.getOffset(e,t.parentNode)};OJ.text=function(e){var t="";e=e.childNodes||e;for(var n=0;n<e.length;n++){t+=e[n].nodeType!=1?e[n].nodeValue:text(e[n].childNodes)}return t};OJ.getWH=function(){if(window.innerHeight)winHeight=window.innerHeight;else if(document.body&&document.body.clientHeight)winHeight=document.body.clientHeight;return winHeight};OJ.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))};OJ.addClass=function(e,t){if(!this.hasClass(e,t))e.className+=" "+t};OJ.removeClass=function(e,t){if(OJ.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}};OJ.toggleClass=function(e,t){if(hasClass(e,t)){OJ.removeClass(e,t)}else{OJ.addClass(e,t)}};OJ.toggleClassTest=function(){var e=document.getElementById("test");OJ.toggleClass(e,"testClass")};OJ.remove=function(e){var t=e.parentNode;if(t){t.removeChild(e)}};OJ.getTime=function(){var e=new Date;return e.getTime()};function UDevice(){}UDevice.prototype.constructor=UDevice;UDevice.prototype.HasPerformance;UDevice.prototype.DevicePixelRatio;UDevice.prototype.ImgRatio;UDevice.prototype.BrowserID;UDevice.prototype.PlatformID;UDevice.prototype.isApple;UDevice.prototype.isMobile;UDevice.prototype.LoopInterval;UDevice.me;UDevice.getMe=function(){if(UDevice.me==null){UDevice.me=new UDevice;UDevice.me.init()}return UDevice.me};UDevice.prototype.init=function(){this.DevicePixelRatio=UDevice.getDevicePixelRatio();this.HasPerformance=UDevice.supportPerformance();this.ImgRatio=UDevice.getImgRatio();this.BrowserID=UDevice.CheckExplorerID();this.PlatformID=UDevice.getPlatformID();this.isApple=this.checkIsApple();this.isMobile=this.checkIsMobile();this.HasFastLoop=this.supportFastLoop()};UDevice.checkSupportAdvanceH5=function(){var e=document.createElement("canvas");e.h5ou=false;var t={h5qu:false,h5ru:false,set_opacity:true,zDistance:true,h5tu:false,h5uu:false,h5vu:true};var n=["experimental-webgl","webgl","webkit-3d","moz-webgl"];for(var i=0;i<n.length;i++){try{e.h5ou=e.getContext(n[i],t)}catch(e){}if(e.h5ou){break}}var r=e.h5ou!==false?true:false;e.h5ou=null;e=null;return r};UDevice.check_canvas2d=function(){var e=document.createElement("canvas");var t=e.getContext("2d");var n=typeof t=="object"?true:false;e=null;t=null;return n};UDevice.checkSupportBaseH5=function(){return UDevice.check_transform()&&UDevice.check_canvas2d()};UDevice.check_transform=function(){if(!Ucss.contain_css_attribute("transform webkitTransform mozTransform oTransform msTransform"))return false;if(!Ucss.isSupport_perspective()){return false}return true};UDevice.prototype.getBestLoopInterval=function(){switch(this.PlatformID){case 1:return 33;case 2:var e=this.getSthNum222();switch(e){case 0:return 50;case 1:return 40;case 2:return 33;case 3:return 25;default:return 33}return 5;case 3:return 33;case 4:return 33;default:return 33}};UDevice.prototype.getSthNum222=function(){var e=UDevice.getMe().screenSize.x<UDevice.getMe().screenSize.y?UDevice.getMe().screenSize.x:UDevice.getMe().screenSize.y;var t=UDevice.getMe().screenSize.x<UDevice.getMe().screenSize.y?UDevice.getMe().screenSize.y:UDevice.getMe().screenSize.x;if(e==320)return t==480?0:1;if(e==375)return 2;if(e==414)return 3;return-1};UDevice.prototype.supportFastLoop=function(){return window.requestAnimationFrame!==undefined?true:false};UDevice.prototype.isScreenScaleOK=function(){if(!UDevice.getMe().isMobile){return false}var e=3/4;var t=UDevice.getMe().screenSize.x/UDevice.getMe().screenSize.y;var n=Math.abs(e-t);if(n<.01){return true}return UDevice.getMe().screenSize.x>=580?true:false};UDevice.prototype.checkIsMobile=function(){return this.PlatformID>=0&&this.PlatformID<=4};UDevice.supportPerformance=function(){if(typeof window.h5qq!=="undefined"){if(typeof window.h5qq.now!=="undefined"){return true}}return false};UDevice.prototype.checkIsApple=function(){switch(this.PlatformID){case 2:return true;case 1:default:return false}};UDevice.getDevicePixelRatio=function(){return window.devicePixelRatio!==undefined?Math.max(window.devicePixelRatio,1):1};UDevice.getScreenSize=function(){if(window.screen==undefined){return UDevice.countScreenSize(window.innerWidth,window.innerHeight)}if(window.screen.width==undefined){return UDevice.countScreenSize(window.innerWidth,window.innerHeight)}return UDevice.countScreenSize(window.screen.width,window.screen.height)};UDevice.countScreenSize=function(e,t){};UDevice.getImgRatio=function(){return 1/UDevice.getDevicePixelRatio()};UDevice.CheckExplorerID=function(){if(navigator.userAgent.indexOf("Firefox")!=-1)return 2;else if(navigator.userAgent.indexOf("Chrome")!=-1)return 3;else if(navigator.userAgent.indexOf("Safari")!=-1)return 4;else if(navigator.userAgent.indexOf("MSIE")!=-1)return 1;else if(navigator.userAgent.indexOf("rv:")!=-1)return 1;else if(navigator.userAgent.indexOf("iPhone")!=-1)return 4;else if(navigator.userAgent.indexOf("iPod")!=-1)return 4;else if(navigator.userAgent.indexOf("iPad")!=-1)return 4;return 0};UDevice.getPlatformID=function(){if(navigator.userAgent.indexOf("Android")!=-1)return 1;else if(navigator.userAgent.indexOf("iPad")!=-1)return 2;else if(navigator.userAgent.indexOf("iPod")!=-1)return 2;else if(navigator.userAgent.indexOf("iPhone")!=-1)return 2;else if(navigator.userAgent.indexOf("webOS")!=-1)return 3;else if(navigator.userAgent.indexOf("mobile")!=-1)return 4;else if(navigator.userAgent.indexOf("Windows Phone")!=-1)return 4;else if(navigator.userAgent.indexOf("Windows Mobile")!=-1)return 4;else if(navigator.userAgent.indexOf("IEMobile")!=-1)return 4;else if(navigator.userAgent.indexOf("Nokia")!=-1)return 4;else if(navigator.appVersion.indexOf("Win")!=-1)return 5;else if(navigator.appVersion.indexOf("Mac")!=-1)return 6;else if(navigator.appVersion.indexOf("Linux")!=-1)return 7;else if(navigator.appVersion.indexOf("X11")!=-1)return 8;return 0};UDevice.is_weixin=function(){var e=navigator.userAgent.toLowerCase();if(e.match(/MicroMessenger/i)=="micromessenger"){return true}else{return false}};function WXDevil(){}WXDevil.prototype.constructor=WXDevil;WXDevil.me;WXDevil.getMe=function(){if(WXDevil.me==null){WXDevil.me=new WXDevil}return WXDevil.me};WXDevil.prototype.killWXdevil=function(){var e=this;if(UDevice.getMe().isMobile){document.addEventListener("touchmove",function(t){e.setXorYType22(t)});document.addEventListener("touchstart",function(t){e.setclientXorY22(t)});document.addEventListener("touchend",function(t){e.clearSthCCC(t)})}else{if(window.h5xo){document.onmousemove=function(t){e.setXorY(t)};document.onmousedown=function(t){e.h5ep(t)};document.onmouseup=function(t){e.clearSthBBB(t)}}else{document.onmousemove=function(t){e.setXorYType2(t)};document.onmousedown=function(t){e.setclientXorY(t)};document.onmouseup=function(t){e.clearSthAAA(t)}}}};WXDevil.prototype.setXorYType22=function(e){this.isTouched=true;e.preventDefault()};WXDevil.prototype.setclientXorY22=function(e){this.isTouched=true};WXDevil.prototype.setclientXorY=function(e){this.isTouched=true};WXDevil.prototype.setXorYType33=function(e){this.isTouched=true};WXDevil.prototype.clearSthCCC=function(e){this.isTouched=false};WXDevil.prototype.clearSthAAA=function(e){this.isTouched=false};WXDevil.prototype.clearSthBBB=function(e){this.isTouched=false};WXDevil.prototype.setXorYType2=function(e){};WXDevil.prototype.setXorY=function(e){};function Evt(e,t){this.type=e;this.news=t==null?undefined:t}Evt.prototype={constructor:Evt,type:undefined,news:undefined};function SiteEvt(e){if(e!=SiteEvt._guard||SiteEvt._guard==null){}}SiteEvt._instance=undefined;SiteEvt._guard=undefined;SiteEvt.list={};SiteEvt.listOnce={};SiteEvt.getMe=function(){if(SiteEvt._instance==null){SiteEvt._instance=new SiteEvt(SiteEvt._guard=arguments.callee)}return SiteEvt._instance};SiteEvt.rea=function(e){SiteEvt.getMe().removeAll(e)};SiteEvt.re_=function(e,t){SiteEvt.getMe().remove(e,t)};SiteEvt.add=function(e,t,n){SiteEvt.getMe().addEvt(e,t,n)};SiteEvt.dis=function(e,t){SiteEvt.getMe().dispatch(new Evt(e,t))};SiteEvt.prototype={constructor:SiteEvt,addEvt:function(e,t,n){if(SiteEvt.list[e]==null){SiteEvt.list[e]={};SiteEvt.list[e].listener=[];SiteEvt.list[e].listener.push(t);SiteEvt.list[e].ref=[];SiteEvt.list[e].ref.push(n)}else{SiteEvt.list[e].listener.push(t);SiteEvt.list[e].ref.push(n)}},getInfo:function(e){return'[type="'+e+'",'+"len=["+SiteEvt.list[e].listener.length+"]]"},hasType:function(e){return SiteEvt.list[e]==null?false:true},has:function(e,t){if(SiteEvt.list[e]==null){return false}else{var n=SiteEvt.list[e].listener.length;for(var i=0;i<n;i++){if(SiteEvt.list[e].listener[i]==t){return true}}}return false},addOnce:function(e,t){if(SiteEvt.listOnce[e]==null){SiteEvt.listOnce[e]={};SiteEvt.listOnce[e].listener=[];SiteEvt.listOnce[e].listener.push(t);SiteEvt.listOnce[e].ref=[];SiteEvt.listOnce[e].ref.push(t)}else{SiteEvt.listOnce[e].listener.push(t);SiteEvt.listOnce[e].ref.push(t)}},dispatch:function(e){this.dispatchNormal(e);this.dispatchOnce(e)},dispatchNormal:function(e){if(SiteEvt.list[e.type]==null)return;var t=SiteEvt.list[e.type].listener.length-1;for(var n=t;n>=0;n--){if(SiteEvt.list[e.type]!=null&&SiteEvt.list[e.type].listener[n]!=null&&SiteEvt.list[e.type].ref[n]!=null)SiteEvt.list[e.type].listener[n].apply(SiteEvt.list[e.type].ref[n],[e])}},dispatchOnce:function(e){if(SiteEvt.listOnce[e.type]==null)return;var t=SiteEvt.listOnce[e.type].listener.length-1;for(var n=t;n>=0;n--){if(SiteEvt.listOnce[e.type]!=null&&SiteEvt.listOnce[e.type].listener[n]!=null&&SiteEvt.listOnce[e.type].ref[n]!=null){SiteEvt.listOnce[e.type].listener[n].apply(SiteEvt.listOnce[e.type].ref[n],[e]);SiteEvt.listOnce[e.type].listener.splice(n,1);SiteEvt.listOnce[e.type].ref.splice(n,1)}}},removeAll:function(e){if(SiteEvt.list[e]==null)return;SiteEvt.list[e]=null},remove:function(e,t){if(SiteEvt.list[e]==null)return;var n=SiteEvt.list[e].listener.length-1;for(var i=n;i>=0;i--){if(SiteEvt.list[e].listener!=null&&SiteEvt.list[e].listener[i]==t){SiteEvt.list[e].listener.splice(i,1);SiteEvt.list[e].ref.splice(i,1)}}}};function enumID(){}enumID.prototype.constructor=enumID;enumID.onresize=1;enumID.onorientationchange=2;enumID.onrotated=4;function JS90(){WXDevil.getMe().killWXdevil();UDevice.getMe().init();var e=$(window).width();var t=$(document.body).height();this.state=0;SiteEvt.add(enumID.onresize,this.onresize,this);this.onresize()}JS90.prototype.constructor=JS90;JS90.prototype.state;JS90.getWH=function(){var e=document.body.clientWidth;var t=document.body.clientHeight;if(e>t){return[e,t]}else{return[t,e]}};JS90.prototype.onresize=function(e){var t=$(window).width();var n=$(window).height();if(t<n){this.doV()}else{this.do__()}SiteEvt.dis(enumID.onrotated)};JS90.prototype.onorientationonchange=function(e){var t=window.orientation;if(t==90||t==-90){this.doV()}else{this.do__()}};JS90.prototype.do__=function(){var e=document.body.clientWidth;var t=document.body.clientHeight;document.body.style.transform="rotate(0deg)";document.body.style.width=e+"px";document.body.style.height=t+"px"};JS90.prototype.doV=function(){var e=document.body.clientWidth;var t=document.body.clientHeight;var n=(t-e)/2+"px";document.body.style.transform="rotate(90deg) translate("+n+","+n+")";document.body.style.width=t+"px";document.body.style.height=e+"px";document.body.style.display="block"};function Main(){var e=document.body.getAttribute("class");var t=/\S+/g;var n=[1];while(n){var n=t.exec(e);if(n){n.map(function(e){if(window[e]){new window[e]}else{}})}}window.onresize=function(){SiteEvt.dis(enumID.onresize)};window.onorientationchange=function(){SiteEvt.dis(enumID.onorientationchange)}}Main.prototype.constructor=Main;function init(){new Main}function ScreenShare_Face(e){$(".last").show();this.maleOriginal=$(".last .male");this.doDraw1(e)}ScreenShare_Face.prototype.constructor=ScreenShare_Face;ScreenShare_Face.prototype.cvs2;ScreenShare_Face.prototype.maleOriginal;ScreenShare_Face.prototype.doDraw1=function(e){var t=1136;var n=684;var i=$(".game-main-end .last .lastDom");var r=uPEC.aDiv(".last-photo",".game-main-end .last .lastDom");var o=uPEC.aDiv();var a=uPEC.aCanvas(t,n);var s=uPEC.aCanvas(t,n);this.cvs1=a;this.cvs2=s;this.cvs2.appendTo(r);var c=a[0];var u=c.getContext("2d");u.fillStyle="0";u.fillRect(0,0,t,n);u.stroke();if(e==1){var l=$(".buffer .buffer1 img")[0]}else{var l=$(".buffer .buffer2 img")[0]}u.save();if(e==1){var f=70;var v=94}else{var f=76;var v=102}if(e==1){var d=938;var p=131}else{var d=941;var p=177}u.translate(d,p);u.rotate(-4*Math.PI/180);u.drawImage(l,-f/2,-v/2,f,v);u.restore();if(e==1){var g=$(".lastPhoto .male .black img")[0]}else{var g=$(".lastPhoto .female .black img")[0]}u.globalCompositeOperation="xor";u.drawImage(g,-1,-1);var h=s[0];var m=h.getContext("2d");if(e==1){var S=$(".lastPhoto .male .bg img")[0]}else{var S=$(".lastPhoto .female .bg img")[0]}m.drawImage(S,0,0);if(e==1){m.drawImage(c,0,0)}else{m.drawImage(c,0,0)}var y=this.maleOriginal;var D=this.maleOriginal.position();var w=this.maleOriginal.css("left");var E=this.maleOriginal.css("top");var O=uPEC.convertCanvasToImage(this.cvs2[0]);r.find("canvas").css({width:"100%",bottom:"0"});$(O).css({width:"100%",bottom:"0"});r.empty();r.append($(O));console.log(i);i.css("transform","rotate(-3deg)");i.css("visibility","visible");$(".last .male").hide();$(".last .female").hide()};function Shareout(){new JS90;UDevice.getMe();WXDevil.getMe().killWXdevil();this.loadimg()}Shareout.prototype.constructor=Shareout;Shareout.prototype.loadimg=function(){H5Loader.loadImg_oj(".game-main-end img",this.oning,this.onok,this)};Shareout.prototype.oning=function(){};Shareout.prototype.onok=function(){$(".game-main-end>div").show();this.initpic()};Shareout.prototype.initpic=function(){var e=ABC.path;var t=OJ.GetQueryString("test");console.log(ABC.gender);if(ABC.isstatic){if(ABC.gender==1){e="images/m1.jpg"}if(ABC.gender==2){e="images/f1.jpg"}}JSdebug.print("jump",ABC.gender);if(ABC.gender==1){var n=$(".buffer .buffer1 img")[0];n.onload=function(){JSdebug.print("图片加载完成",this.src);new ScreenShare_Face(1)};n.onerror=function(){JSdebug.print("图片加载失败",this.src)};n.src=e;JSdebug.print("图片",e,n)}if(ABC.gender==2){var i=$(".buffer .buffer2 img")[0];i.onload=function(){JSdebug.print("图片加载完成",ABC.gender);new ScreenShare_Face(2)};i.onerror=function(){JSdebug.print("图片加载失败",this.src)};i.src=e;JSdebug.print("图片",e,i)}};function uPEC(){}uPEC.prototype.constructor=uPEC;uPEC.aCanvas=function(e,t){var n=$("<canva"+"s></canva"+"s>");var i=n[0];i.width=e;i.height=t;return n};uPEC.aDiv=function(e,t){var n=$('<div class="abs"></div>');if(t){n.appendTo($(t))}else{n.appendTo($("#pageWrap"))}if(e){if(e.indexOf(".")>-1){var i=e.replace(".","");n.addClass(i)}}return n};uPEC.convertCanvasToImage=function(e){var t=new Image;t.src=e.toDataURL("image/png");return t};uPEC.GetQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");var n=window.location.search.substr(1).match(t);if(n!=null)return unescape(n[2]);return null};